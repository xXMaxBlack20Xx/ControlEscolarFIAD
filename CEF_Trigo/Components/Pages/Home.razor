@page "/"

@inject NavigationManager Navigation

<div class="page-container">
    <!-- El header y navbar se mantienen igual, ya que el diseño es el correcto -->
    <header class="main-header">
        <div class="banner-image">
            <div class="banner-overlay"></div>
        </div>
        <nav class="navbar navbar-expand-lg navbar-dark">
            <div class="container-fluid">
                <!-- Logo y Nombre -->
                <a class="navbar-brand d-flex align-items-center" href="/">
                    <img src="/favicon.png" alt="Logo UABC" height="60" class="me-2">
                    <div class="d-flex flex-column">
                        <span class="brand-title">FIAD</span>
                        <span class="brand-subtitle">Control Escolar</span>
                    </div>
                </a>

                <!-- Botón para menú móvil -->
                <button class="navbar-toggler" type="button" @onclick="ToggleNavMenu" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Menú de Navegación -->
                <div class="@NavMenuCssClass" id="navbarNav">
                    <ul class="navbar-nav ms-auto text-center">
                        <li class="nav-item"><a class="nav-link" href="/carreras">Carreras</a></li>
                        <li class="nav-item"><a class="nav-link" href="/planes-estudio">Planes de Estudio</a></li>
                        <li class="nav-item"><a class="nav-link" href="/alumnos">Alumnos</a></li>
                        <li class="nav-item"><a class="nav-link" href="/reportes">Reportes</a></li>
                        <li class="nav-item"><a class="nav-link" href="/pruebas">Pruebas</a></li>
                    </ul>
                </div>
            </div>
        </nav>
        <div class="header-content container text-center">
            <h1 class="display-5 text-white">Sistema de Gestión Académica</h1>
            <p class="lead text-white-50">Facultad de Ingeniería, Arquitectura y Diseño</p>
        </div>
    </header>

    <!-- CONTENIDO PRINCIPAL: MÓDULOS DE GESTIÓN -->
    <main class="main-content container my-5">
        <div class="mb-5 text-center">
            <h2>Panel de Control</h2>
            <p class="text-muted">Selecciona un módulo para comenzar a gestionar la información.</p>
        </div>

        <!-- Listado de Módulos en Tarjetas -->
        <div class="row g-4 justify-content-center">
            @foreach (var modulo in ModulosDeGestion)
            {
                <div class="col-lg-4 col-md-6 d-flex align-items-stretch">
                    <div class="card gestion-card h-100 shadow-sm">
                        <div class="card-body text-center">
                            <div class="icon-circle mb-3">
                                <i class="bi @modulo.Icono"></i>
                            </div>
                            <h5 class="card-title">@modulo.Nombre</h5>
                            <p class="card-text text-muted small">@modulo.Descripcion</p>
                        </div>
                        <div class="card-footer">
                            <button class="btn btn-primary w-100" @onclick="() => NavegarAModulo(modulo.Url)">
                                Gestionar
                            </button>
                        </div>
                    </div>
                </div>
            }
        </div>
    </main>

    <!-- FOOTER -->
    <footer class="footer mt-auto py-4">
        <div class="container text-center">
            <small>&copy; @DateTime.Now.Year Universidad Autónoma de Baja California - Por la realización plena del hombre.</small>
        </div>
    </footer>
</div>

<!-- LÍNEA AÑADIDA PARA IMPORTAR LOS ICONOS DE BOOTSTRAP -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">

@code {
    // Control del menú de navegación en móviles
    private bool collapseNavMenu = true;
    private string? NavMenuCssClass => collapseNavMenu ? "collapse navbar-collapse" : "navbar-collapse";
    private void ToggleNavMenu() => collapseNavMenu = !collapseNavMenu;

    // --- Lógica para los Módulos de Gestión ---
    private List<ModuloGestion> ModulosDeGestion = new();

    protected override void OnInitialized()
    {
        CargarModulos();
    }

    // Método para definir los módulos disponibles en el panel de control
    private void CargarModulos()
    {
        ModulosDeGestion = new List<ModuloGestion>
        {
            new ModuloGestion(
                Nombre: "Carreras",
                Descripcion: "Administra la oferta educativa, altas, bajas y modificaciones de carreras.",
                Icono: "bi-journals",
                Url: "/carreras"),

            new ModuloGestion(
                Nombre: "Planes de Estudio",
                Descripcion: "Gestiona la malla curricular, materias, créditos y prerrequisitos de cada carrera.",
                Icono: "bi-list-check",
                Url: "/planes-estudio"),

            new ModuloGestion(
                Nombre: "Alumnos",
                Descripcion: "Consulta y gestiona los expedientes e información de los estudiantes.",
                Icono: "bi-people-fill",
                Url: "/alumnos"),

            new ModuloGestion(
                Nombre: "Reportes",
                Descripcion: "Exporta informes detallados y visualiza estadísticas para el seguimiento académico y la toma de decisiones.",
                Icono: "bi-file-earmark-bar-graph",
                Url: "/reportes"),

            new ModuloGestion(
                Nombre: "Proximo",
                Descripcion: "Futuras características y mejoras planeadas para el sistema de gestion.",
                Icono: "bi-stars",
                Url: "/"),

            new ModuloGestion(
                Nombre: "Pruebas",
                Descripcion: "Entorno para la validación de nuevos componentes. Exclusivo para desarrollo.",
                Icono: "bi-terminal-fill",
                Url: "/pruebas"),
        };
    }

    // Método para manejar la navegación al hacer clic en un módulo
    private void NavegarAModulo(string url)
    {
        Navigation.NavigateTo(url);
    }

    // Clase para modelar la información de un Módulo de Gestión
    public class ModuloGestion
    {
        public string Nombre { get; set; }
        public string Descripcion { get; set; }
        public string Icono { get; set; }
        public string Url { get; set; }

        public ModuloGestion(string Nombre, string Descripcion, string Icono, string Url)
        {
            this.Nombre = Nombre;
            this.Descripcion = Descripcion;
            this.Icono = Icono;
            this.Url = Url;
        }
    }
}